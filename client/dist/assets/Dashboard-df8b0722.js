import{d as a,j as e,r as o}from"./index-94eab420.js";import{a as Ve}from"./index.esm-e2511e47.js";import{C as Xe,a as h}from"./api-5c20e404.js";import{B as s}from"./chunk-6CSUKJP7-90322ddf.js";import{T as I}from"./chunk-P74GIWPW-2e89ab56.js";import{L as Ye,a as H}from"./chunk-Z47J5YMH-b076794e.js";import{B as b}from"./chunk-NAA7TEES-e6707657.js";import{M as le,a as oe,b as te,u as ae,c as Ze}from"./Sidebar-a2170b0b.js";import{s as er,t as rr}from"./Logo-0c179a24.js";import{T as ar,b as lr,c as or}from"./chunk-IXKZFKRY-0abf1226.js";import{M as ne,u as tr}from"./index-981377b8.js";import{a as se,G as ie,u as nr,U as sr,d as ir}from"./UnavailableMessage-991268a8.js";function dr({type:p,item:f,donateFoodBank:n,applyDiscount:g,alertDate:x,preview:w}){const C=new Date(x).getTime()-new Date().getTime(),i=Math.floor(C/864e5),c={message:i>1?`Expiring in ${i} days!`:i===1?"Expiring in a day!":"Expiring in less than a day!",button1:{name:"Apply Discount",method:g},button2:{name:"Donate Food Bank",method:n}},d={message:"New Supplies needed!",button1:{name:"Preview PAR",method:w},button2:{name:"Custom Order",method:w}};return a(Xe,{w:"100%",h:"12.5rem",variant:"elevated",padding:".75rem",display:"grid",children:[a(s,{display:"flex",alignItems:"center",columnGap:".75rem",children:[e(Ve,{size:24}),e(I,{fontSize:".95rem",color:"#323130",fontFamily:"'Poppins', sans-serif",fontWeight:"semibold",children:p==="expiry"?c.message:d.message})]}),e(s,{mt:".75rem",children:a(Ye,{spacing:4,children:[a(s,{display:"flex",alignItems:"center",justifyContent:"space-between",fontFamily:"'Poppins', sans-serif",children:[e(H,{fontSize:".9rem",children:"Name"}),e(H,{fontWeight:"bold",fontSize:".85rem",children:f.name})]}),a(s,{display:"flex",alignItems:"center",justifyContent:"space-between",fontFamily:"'Poppins', sans-serif",children:[e(H,{fontSize:".9rem",children:"Remaining"}),e(H,{fontWeight:"bold",fontSize:".85rem",children:f.total_units})]})]})}),p==="expiry"?a(s,{display:"flex",alignItems:"center",columnGap:"1rem",children:[e(b,{onClick:c.button1.method,fontWeight:"light",fontFamily:"'Roboto', sans-serif",color:"white",bgColor:"#323130",borderRadius:"4px",mt:"1rem",children:c.button1.name}),e(b,{onClick:c.button2.method,fontWeight:"normal",fontFamily:"'Roboto', sans-serif",bgColor:"#dff4ce",borderRadius:"4px",mt:"1rem",children:c.button2.name})]}):a(s,{display:"flex",alignItems:"center",columnGap:"1rem",children:[e(b,{onClick:d.button1.method,fontWeight:"light",fontFamily:"'Roboto', sans-serif",color:"white",bgColor:"#323130",borderRadius:"4px",mt:"1rem",children:d.button1.name}),e(b,{onClick:d.button2.method,fontWeight:"normal",fontFamily:"'Roboto', sans-serif",bgColor:"#dff4ce",borderRadius:"4px",mt:"1rem",children:d.button2.name})]})]})}function fe({name:p,remove:f}){return a(ar,{size:"md",borderRadius:"full",variant:"solid",colorScheme:"gray",children:[e(lr,{children:p}),e(or,{onClick:f})]},"sm")}function cr({isOpen:p,onClose:f,type:n,productName:g,price:x,description:w,image:C,ingredients:i,name:c,unitName:d,packPrice:t,unitsInAPack:P,expiryPeriod:T,handleType:k,handleProductName:_,handlePrice:S,handleDescription:u,handleImage:y,addIngredient:$,handleName:W,handleUnitName:J,handlePackPrice:K,handleUnitsInAPack:q,handleExpiryPeriod:F,addProduct:R,updateIngredients:E}){const D=!(c&&d&&t&&P&&T),U=!(g&&x&&n&&w&&C&&i.length>0);return a(le,{isOpen:p,onClose:f,children:[e(oe,{}),a(ne,{children:[e(te,{}),e("div",{className:"formbold-main-wrapper",children:a("div",{className:"formbold-form-wrapper",children:[e(I,{w:"100%",textAlign:"center",fontFamily:"'Poppins', sans-serif",padding:"1.5rem 0",fontSize:{base:"1.25rem",lg:"1.5rem"},fontWeight:"semibold",children:"Add a product"}),a("div",{className:"formbold-mb-5",children:[e("label",{className:"formbold-form-label",children:" Type "}),a("select",{required:!0,onChange:k,type:"text",placeholder:"Select type",className:"formbold-form-input",children:[e("option",{value:"burger",children:"Burger"}),e("option",{value:"sandwich",children:"Sandwich"}),e("option",{value:"drinks",children:"Drinks"}),e("option",{value:"sides",children:"Sides"})]})]}),a("div",{className:"formbold-mb-5",children:[e("label",{className:"formbold-form-label",children:" Name "}),e("input",{required:!0,onChange:_,type:"text",placeholder:"Name",className:"formbold-form-input"})]}),a("div",{className:"formbold-mb-5",children:[e("label",{className:"formbold-form-label",children:" Description "}),e("input",{required:!0,onChange:u,type:"text",placeholder:"Description",className:"formbold-form-input"})]}),a("div",{className:"formbold-mb-5",children:[e("label",{className:"formbold-form-label",children:" Price "}),e("input",{required:!0,onChange:S,type:"number",placeholder:"Price",className:"formbold-form-input"})]}),a("div",{className:"formbold-mb-5",children:[e("label",{className:"formbold-form-label",children:" Image"}),e("input",{required:!0,onChange:y,accept:"image/*",type:"file",className:"formbold-form-input"})]}),a("div",{className:"formbold-mb-5 formbold-pt-3",children:[e("label",{className:"formbold-form-label formbold-form-label-2",children:"Add ingredients"}),a("div",{className:"flex flex-wrap formbold--mx-3",children:[e("div",{className:"w-full sm:w-half formbold-px-3",children:e("div",{className:"formbold-mb-5",children:e("input",{value:c,required:!0,onChange:W,type:"text",placeholder:"Name",className:"formbold-form-input"})})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:e("div",{className:"formbold-mb-5",children:e("input",{value:d,required:!0,type:"text",onChange:J,placeholder:"Unit Name",className:"formbold-form-input"})})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:e("div",{className:"formbold-mb-5",children:e("input",{value:t,required:!0,onChange:K,type:"number",placeholder:"Pack price",className:"formbold-form-input"})})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:e("div",{className:"formbold-mb-5",children:e("input",{value:P,required:!0,onChange:q,type:"number",placeholder:"Units In A Pack",className:"formbold-form-input"})})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:e("div",{className:"formbold-mb-5",children:e("input",{value:T,required:!0,onChange:F,type:"number",placeholder:"Expiry period in days",className:"formbold-form-input"})})})]}),e(b,{fontWeight:"normal",fontFamily:"'Roboto', sans-serif",bgColor:"#dff4ce",borderRadius:"4px",mt:"1rem",isDisabled:D,onClick:$,children:"Add"}),e(se,{w:"100%",display:"grid",templateColumns:{base:"repeat(2, 1fr)",sm:"repeat(3, 1fr)"},gap:2,mt:"2rem",children:i==null?void 0:i.map((B,O)=>e(ie,{children:e(fe,{name:B.name,remove:E})},O))})]}),e(b,{fontWeight:"light",fontFamily:"'Roboto', sans-serif",color:"white",bgColor:"#323130",borderRadius:"4px",mt:"1rem",isDisabled:U,onClick:R,children:"Add new product"})]})})]})]})}function mr({isOpen:p,onClose:f,supplies:n,itemInfo:g,name:x,unitName:w,packPrice:C,unitsInAPack:i,expiryPeriod:c,addItem:d,totalPacks:t,handleSupplyInputs:P,handleTotalPacks:T,updateSupplies:k,total:_,orderSupplies:S}){return a(le,{isOpen:p,onClose:f,children:[e(oe,{}),a(ne,{children:[e(te,{}),e("div",{className:"formbold-main-wrapper",children:a("div",{className:"formbold-form-wrapper",children:[a("div",{className:"formbold-mb-5 formbold-pt-3",children:[e("label",{className:"formbold-form-label formbold-form-label-2",children:"Add an item"}),a("div",{className:"flex flex-wrap formbold--mx-3",children:[e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Item"}),e("select",{required:!0,onChange:P,className:"formbold-form-input",children:g==null?void 0:g.map((u,y)=>e("option",{children:u.name},y))})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Unit Name"}),e("input",{readOnly:!0,value:w,type:"text",placeholder:"Unit Name",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Pack Price"}),e("input",{readOnly:!0,value:C,type:"number",placeholder:"Pack price",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Units In A Pack"}),e("input",{readOnly:!0,value:i,type:"number",placeholder:"Units In A Pack",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Expiry Period"}),e("input",{readOnly:!0,value:c,type:"number",placeholder:"Expiry period in days",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Total Packs"}),e("input",{onChange:T,value:t,required:!0,type:"number",placeholder:"Enter total packs",className:"formbold-form-input",min:"1"})]})})]}),e(b,{fontWeight:"normal",fontFamily:"'Roboto', sans-serif",bgColor:"#dff4ce",borderRadius:"4px",mt:"1rem",isDisabled:!(x&&t),onClick:d,children:"Add"})]}),a(s,{display:"grid",rowGap:"2.5rem",justifyItems:"center",children:[e(se,{display:"grid",templateColumns:{base:"repeat(2, 1fr)",sm:"repeat(3, 1fr)"},gap:4,children:n==null?void 0:n.map((u,y)=>e(ie,{children:e(fe,{name:u.name,remove:k})},y))}),e(s,{w:"100%",border:"1px solid #e4e9eb",padding:"1rem",display:"grid",rowGap:"1rem",borderRadius:"5px",children:n==null?void 0:n.map((u,y)=>a(s,{display:"flex",justifyContent:"space-between",w:"100%",children:[a(I,{children:[u.name,"(",u.total_packs,")"]}),a(I,{children:["$",(u.total_packs*u.pack_price).toFixed(2)]})]},y))}),e(s,{w:"100%",border:"1px solid #e4e9eb",padding:"1rem",display:"grid",borderRadius:"5px",children:a(s,{display:"flex",justifyContent:"space-between",w:"100%",children:[e(I,{children:"Total"}),a(I,{children:["$",_==null?void 0:_.toFixed(2)]})]})}),e(b,{fontWeight:"light",fontFamily:"'Roboto', sans-serif",color:"white",bgColor:"#323130",borderRadius:"4px",mt:"1rem",isDisabled:!((n==null?void 0:n.length)>0),onClick:S,children:"Order Supplies"})]})]})})]})]})}function pr({isOpen:p,onClose:f,name:n,unitName:g,packPrice:x,unitsInAPack:w,expiryPeriod:C,previewType:i,handleTotalPacks:c,confirmOrder:d,totalPacks:t}){return a(le,{isOpen:p,onClose:f,children:[e(oe,{}),a(ne,{children:[e(te,{}),e("div",{className:"formbold-main-wrapper",children:e("div",{className:"formbold-form-wrapper",children:a("div",{className:"formbold-mb-5 formbold-pt-3",children:[e("label",{className:"formbold-form-label formbold-form-label-2",children:"Add an item"}),a("div",{className:"flex flex-wrap formbold--mx-3",children:[e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Name"}),e("input",{readOnly:!0,value:n,type:"text",placeholder:"Name",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Unit Name"}),e("input",{readOnly:!0,value:g,type:"text",placeholder:"Unit Name",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Pack Price"}),e("input",{readOnly:!0,value:x,type:"number",placeholder:"Pack price",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Units In A Pack"}),e("input",{readOnly:!0,value:w,type:"number",placeholder:"Units In A Pack",className:"formbold-form-input"})]})}),e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Expiry Period"}),e("input",{readOnly:!0,value:C,type:"number",placeholder:"Expiry period in days",className:"formbold-form-input"})]})}),i==="Preview PAR"?e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Total Packs"}),e("input",{readOnly:!0,value:t,type:"number",placeholder:"Total Packs",className:"formbold-form-input"})]})}):e("div",{className:"w-full sm:w-half formbold-px-3",children:a("div",{className:"formbold-mb-5",children:[e("label",{children:"Total Packs"}),e("input",{onChange:c,required:!0,type:"number",placeholder:"Enter total packs",className:"formbold-form-input",min:"1"})]})})]}),i==="Preview PAR"?e(b,{fontWeight:"light",fontFamily:"'Roboto', sans-serif",color:"white",bgColor:"#323130",borderRadius:"4px",mt:"1rem",onClick:d,children:"Confirm Order"}):e(b,{fontWeight:"light",fontFamily:"'Roboto', sans-serif",color:"white",bgColor:"#323130",borderRadius:"4px",mt:"1rem",disabled:!(n&&t),onClick:d,children:"Order Supplies"})]})})})]})]})}function _r(){const{isOpen:p,onOpen:f,onClose:n}=ae(),{isOpen:g,onOpen:x,onClose:w}=ae(),{isOpen:C,onOpen:i,onClose:c}=ae(),d=nr(),t=(r,l)=>d({title:l,status:r,duration:1e3,isClosable:!0}),[P,T]=o.useState(""),[k,_]=o.useState(""),[S,u]=o.useState(""),[y,$]=o.useState(0),[W,J]=o.useState(""),[K,q]=o.useState([]),[F,R]=o.useState(""),[E,D]=o.useState(""),[U,B]=o.useState(""),[O,M]=o.useState(""),[j,z]=o.useState(""),[A,Q]=o.useState([]),[de,ue]=o.useState([]),[V,ce]=o.useState(""),[N,X]=o.useState([]),[he,be]=o.useState(0),ge=r=>{T(r.target.value)},ye=r=>{_(r.target.value)},ve=r=>{$(r.target.value)},we=r=>{u(r.target.value)},Ne=r=>{J(r.target.files[0])},xe=async()=>{(await h.post("/product",K,{headers:{"Content-Type":"multipart/form-data"}})).data.error?t("error","Error!"):(q(null),Q([]),t("success","Product added successfully!"))};o.useEffect(()=>{q({product_id:tr(5),type:P,name:k,price:y,description:S,image:W,ingredients:A})},[k,y,S,W,P,A]);const Ce=r=>{R(r.target.value)},Pe=r=>{D(r.target.value)},ke=r=>{B(r.target.value)},_e=r=>{M(r.target.value)},Se=r=>{z(r.target.value)},Oe=()=>{Q(r=>[...r,{name:F,unit_name:E,pack_price:U,unit_in_a_pack:O,expiry_period:j}]),R(""),D(""),B(""),M(""),z("")},Ae=r=>{const l=r.target.parentElement.children[0].innerHTML;Q(A==null?void 0:A.filter(m=>m.name!==l))},Ie=async()=>{const r=await h.get("/supplies");ue(r.data.supplies)},Te=r=>{R(r.target.value);const l=de.filter(m=>m.name===r.target.value)[0];D(l.unit_name),B(l.pack_price),M(l.units_in_a_pack),z(l.expiry_period)},Fe=r=>{ce(r.target.value)},Re=()=>{X(r=>[...r,{name:F,unit_name:E,pack_price:U,units_in_a_pack:O,expiry_period:j,total_packs:V,total_units:V*O}]),R(""),D(""),B(""),M(""),z(""),ce("")},Ee=r=>{const l=r.target.parentElement.children[0].innerHTML;X(N==null?void 0:N.filter(m=>m.name!==l))},De=()=>{var r=0;N==null||N.map(l=>r+=l.total_packs*l.pack_price),be(r)},Ue=async()=>{await h.post("/purchases",N),(await h.post("/inventory/admin",N)).data.error?t("error","Error!"):(X([]),t("success","Ordered supplies successfully!"))};o.useEffect(()=>{Ie()},[]),o.useEffect(()=>{De()},[N]);const[v,Be]=o.useState(),[We,Y]=o.useState(!1),[Z,qe]=o.useState(),[Me,je]=o.useState(),[G,ze]=o.useState(),[me,Ge]=o.useState(),L=async()=>{const r=await h.get("/alerts");Be(r.data.alerts)},Le=async r=>{const l=await h.post("/discount",r);l.data.message?(t("success",l.data.message),L()):t("error","Error")},He=async r=>{const l=await h.post("/foodbank",r);l.data.message?(t("success",l.data.message),L()):t("error","Error")},$e=async()=>{const r=v==null?void 0:v.filter(m=>m.alert_tag==="count"),l=v&&await h.post("/par",r);ze(l==null?void 0:l.data.par)},Je=(r,l)=>{Y(!0),qe(r.target.innerHTML),je(l),i()},Ke=r=>{Ge(r.target.value)},Qe=async(r,l)=>{if(l==="Custom Order"){delete r.total_packs;const m=Object.assign({total_packs:Number(me)},r),{units_in_a_pack:ee,total_packs:re}=m,pe=ee*re;m.total_units=pe,await h.post("/purchases",[m]),(await h.post("/inventory/alert",[m])).data.error?t("error","Error!"):t("success","Order Confirmed!"),Y(!1)}else{const{units_in_a_pack:m,total_packs:ee}=r,re=m*ee;r.total_units=re,await h.post("/purchases",[r]),(await h.post("/inventory/alert",[r])).data.error?t("error","Error!"):t("success","Order Confirmed!"),Y(!1)}L()};return o.useEffect(()=>{L()},[]),o.useEffect(()=>{$e()},[v]),e(s,{display:"flex",w:"100vw",h:"100vh",children:a(s,{w:{base:"100vw",lg:"85vw"},padding:{base:"0 1rem",sm:"0 1.5rem",md:"0 1.75rem",xl:"0 2rem"},ml:{lg:"15vw"},minH:"100vh",children:[e(Ze,{}),a(s,{mt:"1.5rem",display:{xs:"grid",sm:"flex"},flexDirection:"row-reverse",justifyContent:"space-between",rowGap:".5rem",w:"100%",children:[a(s,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e(b,{onClick:x,colorScheme:"cyan",color:"gray.500",variant:"ghost",leftIcon:e(er,{}),children:"Order Supplies"}),e(b,{onClick:f,colorScheme:"cyan",color:"gray.500",variant:"ghost",leftIcon:e(rr,{}),children:"Add a product"})]}),e(I,{padding:{base:"1rem",sm:"0"},fontFamily:"'Poppins', sans-serif",fontSize:{base:"1.25rem",lg:"1.5rem"},fontWeight:"semibold",children:"Alerts"})]}),e(s,{mt:"1.5rem",children:(v==null?void 0:v.length)!==0?e(se,{w:"100%",display:"grid",templateColumns:{base:"repeat(1, 1fr)",md:"repeat(2, 1fr)",xl:"repeat(3, 1fr)"},gap:6,paddingBottom:"1.5rem",children:v==null?void 0:v.map(r=>e(ie,{children:e(dr,{type:r.alert_tag,item:r.item,alertDate:r.item.expiry_date,applyDiscount:()=>Le(r),donateFoodBank:()=>He(r),preview:l=>Je(l,r.item)})},r._id))}):e(sr,{logo:e(ir,{size:36}),message:"No alerts found"})}),e(cr,{isOpen:p,onClose:n,type:P,productName:k,price:y,description:S,image:W,ingredients:A,name:F,unitName:E,unitsInAPack:O,packPrice:U,expiryPeriod:j,handleType:ge,handleProductName:ye,handlePrice:ve,handleDescription:we,handleImage:Ne,addIngredient:Oe,addProduct:xe,handleName:Ce,handleUnitName:Pe,handlePackPrice:ke,handleUnitsInAPack:_e,handleExpiryPeriod:Se,updateIngredients:Ae}),e(mr,{isOpen:g,onClose:w,supplies:N,itemInfo:de,ingredients:A,name:F,unitName:E,unitsInAPack:O,packPrice:U,expiryPeriod:j,totalPacks:V,total:he,handleSupplyInputs:Te,handleTotalPacks:Fe,addItem:Re,updateSupplies:Ee,orderSupplies:Ue}),We&&G&&(G==null?void 0:G.filter(r=>Me.name===r.name).map((r,l)=>e(pr,{isOpen:C,onClose:c,name:r.name,unitName:r.unit_name,unitsInAPack:r.units_in_a_pack,totalPacks:Z!=="Custom Order"?r.total_packs:me,handleTotalPacks:Ke,packPrice:r.pack_price,previewType:Z,expiryPeriod:r.expiry_period,confirmOrder:()=>Qe(r,Z)},l)))]})})}export{_r as default};
